# Menu

- [专业词汇](#专业词汇)
- [误区](#误区)
    + [明文传输](#明文传输)
    + [客户端password加密](#客户端password加密)
    + [服务端password明文存库](#服务端password明文存库)
- [常规流程](#常规流程)
    + [加盐](#加盐)
    + [https传输层加密](#https传输层加密)
    + [https+加盐](#https+加盐)

## 专业词汇

**原文** 原始数据，未经过任何处理之前的数据信息
**密文** 使用加密算法对原始数据进行处理后，得到的数据信息。
**散列加密算法** 某些加密算法加密后的密文，则无任何解密算法能够处理得到`原文`，此类不可逆转的加密算法称为`散列加密算法`，常见的有：md5、sha1、sha256、crc等
**私钥** 加密算法使用`私钥`作为种子，对`原文`进行处理得到`密文`
**公钥** 解密算法则能使用`公钥`对`密文`进行处理得到`原文`
**对称加密算法** 加解密算法中`公钥`和`密钥`相同，常见的有：AES、DES、3DES
**非对称加密算法** 加解密算法中`公钥`和`密钥`不同，常见的有：RSA

## 误区

### 明文传输

通常网站登录流程为：

1. 客户端发起post请求到服务端
2. 服务端接收到请求信息中的`username`和`password`
3. 服务端通过`username`查询数据库，获取到账号信息，将请求中的`password`与数据库中记录的`password`比较，若相同，返回登录成功，否则返回登录失败

某些小站点，可能采用http协议，用户登录使用明文传输登录信息。该类站点具有重大安全隐患，要么不登录该类网站，要么不在该类网站中保留任何重要信息，且需要避免与其他重要站点相同`username`及`password`。

原因：采用http协议，明文传输登录信息的数据包，可能被网络联路中的任意第三方所解析，一旦第三方解析数据包就能够获取到用户的`username`及`password`等信息。

使用filder抓包如下：

```
Request:

POST http://www.yun3.com/api_v2/usercenter/user/sign-in HTTP/1.1
Host: www.yun3.com
Content-Length: 123
Accept: application/json, text/plain, */*
Content-Type: application/json;charset=UTF-8

{"phone":"","username":"thiefa@xxx.com","captcha_id":"yRzd7fnApkVPRJhwoAeq","captcha_code":"666666","password":"xxxx123"}

Response:

HTTP/1.1 200 OK
Server: nginx/1.12.2
Date: Tue, 19 Feb 2019 09:54:54 GMT
Content-Type: application/json; charset=utf-8
Content-Length: 491

{
    "errno": 0,
    "errmsg": ""
 }
```

### 客户端password加密

既然http协议中，使用明文传输`username`及`password`信息不靠谱，那客户端在发送请求之前，对`password`进行hash，然后将`hash(password)`传输到服务端，是否就具备了安全性呢？

缺点：

1. 采用这种简单hash的方式，尤其是安全性已经不那么高的`md5`算法等，攻击者通过查询彩虹表就能立刻知道用户的原始`password`。
2. 即便客户端采用的是`sha1`、`sha256`等方式进行的hash，攻击者也可以拦截到加密后的密码`password2 = hash(password)`，以后直接使用`password2`进行登录操作，欺骗服务器。

特别提醒：

> 1. 不要使用对称加密算法，对称加密需要将密钥下发给客户端，若攻击人员逆向解析到客户端的密钥后，同时拦截到客户端发送的密文，然后通过密钥对密文进行解密得到原文。而使用散列算法，由于不可逆性，则保证了攻击者无法获取到原文
> 2. Base64 既不是散列，也不是加密算法！ 很多刚接触开发的人员可能会误将Base64当作加密算法，这是非常错误的！Base64仅仅是将二进制等一些不可见字符编码成可见的`字母`、`\`、`=`，无需任何密钥即可解码出原文。

### 服务端password明文存库

有的开发者存储用户账号和密码时，将用户的密码明文存储到DB字段中，这么做存在以下几个安全隐患：
1. 开发者orDB管理员能够获取到所有用户的，用户名&密码信息，若有心存不良的开发人员获取到这些信息，将会给公司&用户造成损害。
2. 服务器或网站可能存在安全漏洞，如sql注入等。攻击者可能利用此类漏洞，获取到全部数据库数据，从而窃取用户的账号和密码。（ps：因此不要在重要网站中，都使用相同的密码）

## 常规流程

